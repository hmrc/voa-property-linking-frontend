@import _root_.template.Display

@(model: controllers.ManagePropertiesVM)(implicit request: Request[_])


@main_template(title = Messages("dashboard.home.title")) {
        <div class="grid-row">
            <div class="column-two-thirds">
                <h1 class="form-title heading-xlarge">
                    <span class="section-title">@Messages("dashboard.manageProperties.title")</span>
                </h1>
            </div>
        </div>
        <table class="table">
            <tbody>
                <tr>
                    <th>Property</th>
                    <th>Uarn#</th>
                    <th>Connection</th>
                    <th>Status</th>
                    <th>Date added</th>
                    <th>Assessments</th>
                    <th></th>
                    @if(model.properties.pending.exists(_.representations.nonEmpty)) {
                        <th></th>
                    }
                </tr>
                @model.properties.added.map { p =>
                    <tr>
                        <td>@p.name</td>
                        <td>@p.uarn</td>
                        <td>@p.capacity</td>
                        <td>@Messages("dashboard.manageProperties.status.added")</td>
                        <td>@Display.date(p.linkedDate)</td>
                        <td>@p.assessmentYears.mkString(",")</td>
                        <td>
                            <a href=@routes.AppointAgentController.add(p.uarn)>@Messages("dashboard.addAgent")</a>
                        </td>
                        @if(p.representations.nonEmpty) {
                            <td><a href=@routes.AppointAgentController.edit(p.uarn)>
                                @Messages("dashboard.editAgent")
                                </a>
                            </td>
                        }
                    </tr>
                }
                @model.properties.pending.map { p =>
                    <tr>
                        <td>@p.name</td>
                        <td>@p.uarn</td>
                        <td>@p.capacity</td>
                        <td>@Messages("dashboard.manageProperties.status.pending")</td>
                        <td>@Display.date(p.linkedDate)</td>
                        <td></td>
                        <td>
                            <a href=@routes.AppointAgentController.add(p.uarn)>@Messages("dashboard.addAgent")</a>
                        </td>
                        @if(p.representations.nonEmpty) {
                            <td>
                                <a href=@routes.AppointAgentController.edit(p.uarn)>@Messages("dashboard.editAgent")</a>
                            </td>
                        } else {
                            <td></td>
                        }
                    </tr>
                }
            </tbody>
        </table>

        <p><a href="@routes.Search.show" id="addAnotherProperty">@Messages("dashboard.managedProperties.searchLinkText")</a></p>

}
