@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import binders.propertylinks._
@import controllers.propertyLinking.routes._
@import config.ApplicationConfig
@import models.upscan._
@import models._
@import views.html.includes.assessmentHeading
@import actions.propertylinking.requests.LinkingSessionRequest
@import helpers._
@import models.EvidenceType
@import models.CapacityType
@import binders.propertylinks.EvidenceChoices.EvidenceChoices

@this(govukButton: GovukButton, govukTag: GovukTag, govukSummaryList: GovukSummaryList, mainLayout: views.html.mainLayout, formWithCSRF: FormWithCSRF)

@(
        evidenceType: EvidenceType,
        evidenceChoice: EvidenceChoices,
        submissionId: String,
        errors: Option[String] = None,
        uploadedFiles: Map[String, UploadedFileDetails] = Map()
)(implicit request: LinkingSessionRequest[_], messages: Messages, config: ApplicationConfig)

@title = @{
    (request.ses.clientDetails, evidenceType) match {
        case (Some(_), Lease) => {messages("uploadEvidence.lease.client.title")}
        case (Some(_), License) => {messages("uploadEvidence.license.client.title")}
        case (Some(_), RatesBillType) => {messages("uploadRatesBill.show.client.title")}
        case(Some(_), _) => {messages(s"uploadEvidence.$evidenceType.title")}
        case (None, Lease) => {messages("uploadEvidence.lease.title")}
        case (None, License) => {messages("uploadEvidence.license.title")}
        case (None, RatesBillType) => {messages("uploadRatesBill.show.title")}
        case (None, _) => {messages(s"uploadEvidence.$evidenceType.title")}
    }
}

@backUri = @{
    val propertyRelationship = request.ses.propertyRelationship.map(_.capacity).get
    (evidenceType, propertyRelationship) match {
        case (Lease, Owner | OwnerOccupier) => Some(controllers.propertyLinking.routes.UploadController.show(EvidenceChoices.OTHER).url)
        case (License, Owner | OwnerOccupier) => Some(controllers.propertyLinking.routes.UploadController.show(EvidenceChoices.OTHER).url)
        case (Lease, _) => Some(controllers.propertyLinking.routes.ChooseEvidenceController.show.url)
        case (License, _) => Some(controllers.propertyLinking.routes.ChooseEvidenceController.show.url)
        case (noLeaseOrLicense, Occupier) => Some(controllers.propertyLinking.routes.UploadController.show(EvidenceChoices.OTHER).url)
        case (RatesBillType, _) => Some(controllers.propertyLinking.routes.ChooseEvidenceController.show.url)
        case (_, _) => Some(controllers.propertyLinking.routes.UploadController.show(EvidenceChoices.OTHER).url)
    }
}


@mainLayout(
    pageTitle = title,
    backUri = backUri,
    hasErrors = errors.nonEmpty
) {


    @assessmentHeading(request.ses.localAuthorityReference, request.ses.address + "HELLO")

    <h1 class="govuk-heading-xl">Upload receipt</h1>

    <div id="file-upload-1-hint" class="govuk-hint">
        You can upload your receipt as a scanned copy or photo of the original. The selected file must be smaller than 100MB.
    </div>

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            <div class="govuk-visually-hidden" aria-live="polite" id="statusInformation"></div>

            <p class="govuk-body govuk-!-display-none" id="refreshPageProgress"><a href="#" class="govuk-link">Refresh page to update file upload progress</a></p>

            @govukSummaryList(SummaryList(
                classes = "govuk-summary-list--long-key",
                rows = Seq(
                    SummaryListRow(
                        key = Key(content = Text("receipt1.jpg")),
                        value = Value(content = HtmlContent(
                            govukTag(Tag(content = Text("uploading"), classes = "govuk-tag--yellow"))
                        )),
                        actions = Some(Actions(
                            items = Seq(
                                ActionItem(
                                    href = "#",
                                    content = Text("Remove"),
                                    visuallyHiddenText = Some("receipt1.jpg")
                                )
                            )
                        ))
                    )
                )
            ))

            @govukButton(Button(
                content = Text("Continue")
            ))

        </div>
    </div>

}
